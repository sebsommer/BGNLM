import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt

y = np.array([5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 
            10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13, 13, 13, 14, 15, 15, 15, 17, 17, 17, 18, 20, 21, 21])

pred = np.array([3.9536326, 6.059688, 7.6857157, 8.054203, 6.204051, 6.627049, 9.742219, 7.1199, 6.3679028, 9.169318, 6.3996058, 5.791559, 6.638091, 7.222505, 7.9823575, 7.613942, 8.827433, 8.836578, 
        8.198371, 4.8714366, 8.730524, 8.34363, 9.189805, 11.585403, 7.938377, 7.547487, 9.710153, 9.457581, 8.079518, 7.014026, 7.2539835, 7.7960114, 8.055831, 8.3734865, 9.78132, 11.962499, 
        9.828554, 10.612101, 11.137332, 9.598362, 10.071173, 10.550245, 9.112986, 9.963903, 9.050248, 10.239543, 11.478276, 8.615863, 9.054362, 9.479066, 10.473659, 10.069372, 10.053997, 10.560421, 
        9.317439, 9.663128, 10.26186, 9.718152, 10.908357, 9.775381, 7.8552856, 12.222216, 9.781581, 11.504113, 9.48714, 12.59069, 8.130411, 14.581841, 10.16225, 10.014293, 8.844082, 11.261901, 
        8.693529, 9.715846, 11.706521, 13.529917, 13.61711, 12.1856575, 1.208056, 11.613968, 11.8621855, 11.631718, 14.16978, 15.1091585, 16.415144, 16.171906, 12.397308, 14.951007, 14.442643, 18.929213, 13.7947855])

upper = np.array([8.43194436, 11.55888199, 11.15036887, 10.74643222, 11.2650092,   9.63773872,
 14.1070646,  11.682272,   11.74935579, 13.10755842, 10.30670275,  8.9213601,
 10.37222304,  9.50330537, 11.15873835, 12.87190613, 13.04277629, 12.97526402,
 15.11081405,  9.85586416, 13.09266737, 13.92587745, 12.83781481, 19.2328553,
 11.20953211, 10.95476912, 13.96586337, 13.47970851, 11.79879393, 10.84602007,
 13.71462821, 10.59917491, 13.14565863, 12.69031919, 14.01223565, 16.13824129,
 14.09949728, 14.53742644, 17.16934795, 15.86395914, 14.7764727,  15.73798081,
 13.6624978,  15.70411082, 13.34613192, 14.4210597,  17.29603336, 12.6006753,
 13.26879236, 14.65831576, 16.03085138, 14.69678265, 14.70914425, 15.39907949,
 14.78066936, 15.19531667, 14.12713056, 14.35139269, 15.73263637, 13.99453861,
 11.1716201,  16.94824255, 15.77273576, 16.21226351, 13.43329146, 17.9113968,
 12.43864149, 19.5429414,  15.06307333, 14.37700726, 13.26693443, 16.11926837,
 12.58321524, 13.90052688, 16.22500125, 17.73153716, 19.26546569, 18.84171618,
 15.30902439, 17.03978734, 18.66888968, 15.96046163, 19.84043944, 19.81068206,
 21.89747643, 19.95361,    16.86658082, 18.39062038, 19.07950112, 22.98044253,
 19.9788389])

lower = np.array([7.23088047e-01, 2.49030684e+00, 3.37756886e+00, 4.60416865e+00,
 1.62723134e+00, 1.77080617e+00, 4.67147394e+00, 3.90210845e+00,
 1.22191005e+00, 3.98673997e+00, 1.54104417e+00, 1.13334207e+00,
 1.13288047e-02, 2.17440602e+00, 1.73491838e+00, 1.48999197e+00,
 4.39794702e+00, 3.92103673e+00, 3.65265656e+00, 1.44057806e+00,
 5.03457395e+00, 3.88846695e+00, 5.06132360e+00, 5.43332358e+00,
 3.05709258e+00, 3.23471881e+00, 5.53499116e+00, 4.89063506e+00,
 2.37893522e+00, 3.48147476e+00, 3.20532249e+00, 2.92997039e+00,
 2.81443973e+00, 4.96345170e+00, 5.45150357e+00, 7.70395984e+00,
 4.03015138e+00, 6.53866252e+00, 7.66246314e+00, 3.61682318e+00,
 5.20819491e+00, 6.85632035e+00, 3.25462495e+00, 2.64891462e+00,
 4.18490926e+00, 4.89472859e+00, 6.76151591e+00, 4.30551763e+00,
 5.75402972e+00, 5.18388234e+00, 6.03906194e+00, 4.36146135e+00,
 5.41107575e+00, 6.35984821e+00, 3.39355861e+00, 5.96865226e+00,
 5.60619729e+00, 6.18798790e+00, 6.63101884e+00, 3.99492571e+00,
 2.08735324e+00, 6.91626291e+00, 5.70494221e+00, 6.11082479e+00,
 4.80140309e+00, 6.64980515e+00, 4.69885607e+00, 1.03344895e+01,
 5.40718366e+00, 5.43122917e+00, 4.88559499e+00, 7.45418490e+00,
 2.90633553e+00, 3.27282480e+00, 7.36562053e+00, 9.43514382e+00,
 1.01219678e+01, 7.92341973e+00, 7.45823461e+00, 7.20397303e+00,
 7.04873119e+00, 6.21431302e+00, 1.01822020e+01, 9.65879279e+00,
 1.27797099e+01, 1.06329767e+01, 7.63976136e+00, 1.10504659e+01,
 1.13695135e+01, 1.56859980e+01, 7.85378626e+00])

print(pred.shape, y.shape, lower.shape, upper.shape)


sns.set()
fig1, ax1 = plt.subplots()
plt.title(f'RMSE: {1.9375}')
ax1.plot(pred, color = "red", label = 'predicted', linestyle = " ", marker = '.')
ax1.plot(upper, color = "red", linestyle="dashed", alpha = 0.5)
ax1.plot(lower, color= "red", linestyle="dashed", alpha = 0.5)
ax1.plot(y, label = 'target', color = "black", linestyle = " ", marker = '.')
ax1.set_ylabel = ('Age')
ax1.legend()
fig1.savefig('abalone_predictions.png')
print("Prediction plot saved as 'abalone_predictions.png'")
plt.close(fig1)